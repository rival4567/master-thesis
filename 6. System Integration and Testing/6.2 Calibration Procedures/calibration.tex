
Calibration is a crucial procedure in the development of 
an automated robotic workcell, ensuring that all components
operate accurately and in harmony. Robot calibration ensures that the Kassow robot can accurately position its end effector for loading, bending, and unloading metal sheets. This involves:

\subsection{Kinematic Calibration}
\label{subsec:kinematic-calibration}
It refers to the KR1410's kinematic model which needs to correct any discrepancies between the theoretical model and the actual hardware. This includes measuring and compensating for joint offsets, link lengths, and joint angles. 
The KR1410 is already calibrated from the factory and does not need to be setup. Though in simulation, robot kinematic model is generated from the URDF and needs to be updated to match the real hardware. Figure \ref{fig:tcp} shows the kinematic model of KR1410 and also the TCP link which is set at 216 mm from the TFC.

\begin{figure}[h]
    \centering
    \includegraphics[width=1\textwidth]{6. System Integration and Testing/6.2 Calibration Procedures/tcp.PNG}
    \caption{Kinematic model of KR1410 in RViz}
    \label{fig:tcp}
\end{figure}

\subsection{Tool Center Point (TCP) Calibration}
\label{subsubsec:tcp-calibration}
\begin{itemize}
    \item \textbf{}: Determining the exact position of the end effector or tool relative to the robot’s last joint. This is crucial for precise manipulation of metal sheets.
    \item \textbf{Workspace Calibration}: Defining the robot's operational workspace and ensuring that all tasks are performed within this defined area, avoiding collisions and ensuring smooth operation.
\end{itemize}

\begin{figure}[h]
    \centering
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth, angle=0]{figures/001calibration/calibration-process-left.jpeg} % Replace with your image file
        \label{fig:calibration-process-left}
    \end{subfigure}\hspace{0cm}
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth, angle=0]{figures/001calibration/calibration-process-right.jpeg} % Replace with your image file
        \label{fig:calibration-process-right}
    \end{subfigure}
    \caption{KR1410 subprogram to perform calibration automatically}
    \label{fig:auto-calibration-process}
\end{figure}

\subsection{Camera Calibration}
The "Hand-Eye calibration (Robotics)" calibration method is used to determine the
reference between "Hand" (TCP) and "Eye" Camera coordinate system
(position and orientation) when the VISOR\textsuperscript{\textregistered} is attached to the gripper.
This allows different image acquisition positions and still to output the object positions
in robot coordinates directly from the camera.
\cite[page 102]{visor_user_manual}

Camera calibration is essential for the accurate detection of metal sheets and measurement of bending angles. The process involves:

\begin{itemize}
    \item \textbf{Intrinsic Calibration}: Determining the camera's internal parameters, such as focal length, optical center, and lens distortion. This is typically achieved using a calibration target (e.g., a checkerboard pattern) and specialized software tools.
    \item \textbf{Extrinsic Calibration}: Establishing the camera's position and orientation relative to the robot or the workcell. This involves aligning the camera's coordinate system with the robot’s coordinate system to ensure accurate detection and measurement.
\end{itemize}

\subsection{Sensor Calibration}
Laser sensor is added to the bending machine to measure the distance between the tool and die with the reproducibility in the range of 10\textmu m. This sensor help in coordinating the bending timings between the bending machine and the robot. This sensor also requires a baseline or zero point to eliminate any offsets or biases in their readings.

\subsection{Calibration Procedures}

The calibration process is automated within the robot program
such that operator could request to re-calibrate the camera w.r.t
robot TCP from the touch panel. This allows to update the image quality as it degrades over time. 
The robot finishes the current
bending operation and then in next cycle, start with the auto-calibration.

\begin{figure}[h]
    \centering
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration.png}
    \end{subfigure}\hspace{0cm}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration1.png}
    \end{subfigure}
    \vspace{0.1cm}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration2.PNG}
    \end{subfigure}
    \vspace{0.1cm}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration3.png}
    \end{subfigure}\hspace{0cm}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration4.png}
    \end{subfigure}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration5.PNG}
    \end{subfigure}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration6.png}
    \end{subfigure}\hspace{0cm}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration7.png}
    \end{subfigure}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/001calibration/calibration8.PNG}
    \end{subfigure}

    \caption{Acquiring images for the calibration process}
    \label{fig:calibration-steps}
\end{figure}

\begin{figure}
    \centering
    \footnotesize
    \begin{tikzpicture}[node distance=2cm]
    
        % Nodes
        \node (ready) [process] {Move TCP in front of the calibration plate};
        \node (job) [process, below of=ready] {Change active job to Calibration\\ Telegram: CJN1011Calibration};
        \node (start) [process, right of=job, xshift=4.5cm] {Select/activate calibration method\\ Telegram: CSP1100200000015};
        \node (plate) [process, below of=start,yshift=-0.5cm] {Select calibration plate Telegram: CSP1100230000045\\ Calibration plate 15x13 200mm Crosshair 1pc};
        \node (clear) [process, left of=plate,xshift=-4.5cm] {Clear calibration data \\ Telegram: CCD};
        \node (move) [process, below of=clear] {Move to image position};
        \node (point) [coordinate, right of=move, xshift=4.5cm] {};
        \node (acquire) [process, below of=move] {Acquire image \\ Telegram: CAI12000002 + POSE};
        \node (decision) [decision, below of=acquire, yshift=-1cm] {Desired number of images reached?};
        \node (calibrate) [process, below of=decision, yshift=-1cm] {Performing a Hand-Eye calibration \\ Telegram: CRP1140};
        \node (copy) [process, right of=calibrate,xshift=4.5cm] {Copy Calibration to all jobs \\ Telegram: CCC110001};
        \node (complete) [process, below of=copy] {Calibration\\ Complete};

        
        % Arrows
        \draw [arrow] (ready) -- (job);
        \draw [arrow] (job) -- (start);
        \draw [arrow] (start) -- (plate);
        \draw [arrow] (plate) -- (clear);
        \draw [arrow] (clear) -- (move);
        \draw [arrow] (move) -- (acquire);
        \draw [arrow] (acquire) -- (decision);
        \draw [arrow] (decision) -- node[anchor=east] {Yes} (calibrate);
        \draw [-] (decision) -| node[anchor=west, xshift=-4cm, yshift=0.25cm] {No} (point);
        \draw [arrow] (point) -- (move);
        \draw [arrow] (calibrate) -- (copy);
        \draw [arrow] (copy) -- (complete);

        
    \end{tikzpicture}
    \caption{Hand-eye calibration procedure using telegram}
    \label{fig:calib-graph}
\end{figure}


The calibration process involves several systematic steps:

\begin{enumerate}
    \item \textbf{Setup Calibration Targets}: Place calibration targets within the robot's workspace and at specific positions that the cameras will observe.
    \item \textbf{Data Collection}: Use the robot and cameras to collect data from the calibration targets. This includes moving the robot through its range of motion and capturing images from different angles.
    \item \textbf{Parameter Estimation}: Use calibration software to estimate the parameters of the robot’s kinematic model, the intrinsic and extrinsic parameters of the cameras, and the characteristics of any other sensors.
    \item \textbf{Validation}: Verify the calibration by performing tasks that require high precision and checking the accuracy of the results. Adjust calibration parameters as needed based on validation results.
    \item \textbf{Documentation}: Record the calibration parameters and procedures for future reference and troubleshooting.
\end{enumerate}


\subsection{Workspace Calibration}
\label{subsec:workspace-calibration}



